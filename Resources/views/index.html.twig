{#
This file is part of the CampaignChain package.

(c) CampaignChain, Inc. <info@campaignchain.com>

For the full copyright and license information, please view the LICENSE
file that was distributed with this source code.
#}

{% extends 'CampaignChainCoreBundle:Base:base.html.twig' %}

{% block javascripts %}
    {{ parent() }}

    {% javascripts '@blockui_js' combine=true %}
    <script src="{{ asset_url }}"></script>
    {% endjavascripts %}

    <script type="text/javascript">
        $(document).ready(function () {
            $('#campaign_new').on('click', function () {

                var modal = new CampaignChain.Modal();

                modal.init({
                    spinner_start: $.blockUI,
                    spinner_stop: $.unblockUI
                });

                modal.showForm('campaignchain_campaign_template_new');

                $(document).on('campaignchain:form:submit:success', function (e, data) {
                        location.reload();
                });

                // TODO: when there is proper validation in the controller implemented, show error messages here
            });
        });
    </script>
{% endblock %}

{% block body %}
    {% include 'CampaignChainCoreBundle:Base:datatable.html.twig' %}

    <div class="row">
        <div class="col-sm-12 secondary-nav">
            <button class="btn btn-primary" id="campaign_new">
                <span class="fa fa-plus"></span> Create new campaign template
            </button>
        </div>
    </div>

    <!--<div class="table-responsive">-->
    <table id="example" class="table table-striped table-bordered dataTable">
        <thead>
        <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Execution</th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        {% for campaign in repository_campaigns %}
            <tr class="
                            {% if campaign.status == "paused" %}text-muted {% endif %}
                            ">
                <td>{{ campaign|campaignchain_tpl_teaser }}</td>
                <td width="40%">{{ campaign.description }}</td>
                <td>{{ campaign|campaignchain_tpl_trigger_hook_inline }}</td>
                <td align="center">
                    <a class="btn btn-primary"
                       href="{{ path('campaignchain_core_campaign_edit',{'id':campaign.id}) }}">
                        <span class="fa fa-pencil"></span>
                    </a>
                    <a class="btn btn-primary"
                       href="{{ path(campaign.getCampaignModule().getRoutes().plan_detail, {'id':campaign.id}) }}">
                        <span class="fa fa-calendar"></span>
                    </a>
                    {{ campaign.id|campaignchain_btn_copy_campaign }}
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    <!--</div>-->
{% endblock %}
